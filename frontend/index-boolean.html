<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>polycode | Boolean Algebra</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, interactive-widget=resizes-content" />
  <link rel="icon" href="./assets/logo.png" />
  <!-- Same site chrome/theme as C.html -->
  <link rel="stylesheet" href="./css/shell.css" />

  <!-- Your boolean engines (plug your real files here) -->
  <script src="./js/boolean-nobend.js" defer></script>
  <!-- <script src="./js/boolean-truthtable.js" defer></script>
  <script src="./js/boolean-minimize.js" defer></script>
  <script src="./js/boolean-kmap.js" defer></script> -->

  <meta name="color-scheme" content="dark light" />
</head>
<body class="page-fade">
  <!-- Header (same as C.html) -->
  <header class="site-header">
    <div class="brand-wrap">
      <div class="brand-grid">
        <img src="./assets/PC-Logo.png" alt="polycode" class="brand-logo" loading="lazy" decoding="async" />
        <div class="brand-title2">polycode</div>
        <div class="brand-tagline2">learn<span class="dot">.</span>code<span class="dot">.</span>execute</div>
      </div>
    </div>
    <nav class="site-nav">
      <a href="./index.html">Home</a>
      <a href="./about.html">About</a>
      <a href="./contact.html">Contact</a>
    </nav>
  </header>

  <!-- App -->
  <main class="stage" role="main">
    <div class="app" id="appRoot">
      <!-- LEFT: tool switcher + inputs -->
      <section class="panel left" id="leftPanel">
        <div class="pane-head">
          <!-- Dropdown to switch Boolean tools -->
          <select id="toolSelect" class="select" aria-label="Choose Boolean Function">
            <option value="tt">Generate Truth Table</option>
            <option value="min">Minimize Expression</option>
            <option value="min_tt">Minimize with Truth Table</option>
            <option value="logic_generic" selected>Create Logic Diagram - Generic</option>
            <option value="logic_nand">Create Logic Diagram - NAND</option>
            <option value="logic_nor">Create Logic Diagram - NOR</option>
            <option value="sop_pos">Find SOP & POS</option>
            <option value="kmap">Generate KMap</option>
          </select>
          <div class="right-controls">
            <button class="btn expander" onclick="toggleExpand('left', this)" aria-pressed="false" title="Expand Left panel">⤢</button>
          </div>
        </div>

        <div class="pane-scroll">
          <div class="pane-body" id="leftContent">
            <!-- Dynamic form area (changes with dropdown) -->
            <div id="formHost" class="wrap" style="padding:8px 2px;"></div>
          </div>
          <div class="pane-foot"><span class="msg" id="leftFoot">Boolean Tools</span></div>
        </div>
      </section>

      <!-- Center: output/preview area -->
      <section class="panel center" id="centerPanel">
        <div class="pane-head">
          <button id="btnToggleLeft"  class="btn btn-toggle" aria-pressed="false"  title="Show/Hide Left Panel">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <rect x="3" y="4" width="6" height="16" rx="1" />
              <rect x="10" y="4" width="11" height="16" rx="1" fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>

          <button id="themeToggle" class="btn theme-btn" title="Toggle theme" aria-label="Toggle theme">
            <svg viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
          </button>

          <div class="right-controls" style="margin-left:auto; display:flex; gap:8px; align-items:center;">
            <button id="btnDownload" class="btn" title="Download Result" aria-label="Download">
              <svg viewBox="0 0 24 24"><path d="M5 20h14v-2H5v2zM7 9h4V3h2v6h4l-5 5-5-5z" fill="currentColor"/></svg>
            </button>
            <button id="btnRun" class="btn primary attn" title="Run" aria-label="Run">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </div>
        </div>

        <div class="pane-scroll">
          <!-- Output host: we render everything here -->
          <div id="resultHost" style="padding:12px;">
            <div id="logicMount" style="width:100%;max-width:1100px;margin:0 auto;"></div>
            <div id="tableMount" style="margin-top:12px;"></div>
            <div id="textMount" class="mono" style="margin-top:12px;white-space:pre-wrap;"></div>
          </div>
          <div class="pane-foot"><span class="msg" id="centerFoot">Ready</span></div>
        </div>
      </section>

      <!-- RIGHT: console / messages (optional) -->
      <section class="panel right" id="rightPanel">
        <div class="pane-head">
          <div class="right-controls" style="margin-left:auto; display:flex; align-items:center;">
            <button class="btn expander" onclick="toggleExpand('right', this)" aria-pressed="false" title="Expand Output">⤢</button>
            <button id="btnReset" class="btn" title="Reset" aria-label="Reset">
              <svg viewBox="0 0 24 24"><path d="M12 6v3l4-4-4-4v3C7.58 4 4 7.58 4 12s3.58 8 8 8a8 8 0 007.39-4.91l-1.85-.77A6 6 0 1112 6z"/></svg>
            </button>
          </div>
        </div>
        <div class="pane-scroll">
          <div id="output" class="screen-dim" style="padding:12px;">
            <pre id="jconsole" class="console" style="margin:0;"></pre>
          </div>
          <div class="pane-foot"><span class="msg" id="rightFoot">Waiting</span></div>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer (same pattern as C.html) -->
  <footer class="site-footer">
    <div class="footer-grid">
      <div class="footer-left">
        <img src="./assets/logo.png" alt="Edifica" class="footer-logo" />
        <div class="txt">
          <span class="powered">powered by edifica</span>
          <span class="subline">
            education<span class="dot">.</span>consultation<span class="dot">.</span>assistance
          </span>
          <div class="siteurl">
            <a href="https://www.edifica.in" target="_blank" rel="noopener">www.edifica.in</a>
          </div>
        </div>
      </div>
      <div class="footer-center">
        <span class="label">Follow us</span>
        <a class="social" href="https://facebook.com/edifica.facebook" target="_blank" rel="noopener" aria-label="Facebook" title="Facebook">
          <svg viewBox="0 0 24 24" width="18" height="18"><path d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07c0 5.01 3.66 9.16 8.44 9.93v-7.03H7.9v-2.9h2.54V9.41c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.24.2 2.24.2v2.47h-1.26c-1.24 0-1.63.77-1.63 1.56v1.88h2.78l-.44 2.9h-2.34v7.03C18.34 21.23 22 17.08 22 12.07z"/></svg>
        </a>
        <a class="social" href="https://instagram.com/edifica.ig" target="_blank" rel="noopener" aria-label="Instagram" title="Instagram">
          <svg viewBox="0 0 24 24" width="18" height="18"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm6.5-.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM12 9.5A2.5 2.5 0 1 1 9.5 12 2.5 2.5 0 0 1 12 9.5z"/></svg>
        </a>
        <a class="social" href="https://youtube.com/@edifica.youtube" target="_blank" rel="noopener" aria-label="YouTube" title="YouTube">
          <svg viewBox="0 0 24 24" width="18" height="18"><path d="M23.5 6.2a3 3 0 0 0-2.1-2.1C19.4 3.5 12 3.5 12 3.5s-7.4 0-9.4.6A3 3 0 0 0 .5 6.2 31.7 31.7 0 0 0 0 12a31.7 31.7 0 0 0 .6 5.8 3 3 0 0 0 2.1 2.1c2 .6 9.3.6 9.3.6s7.4 0 9.4-.6a3 3 0 0 0 2.1-2.1c.4-1.9.6-3.9.6-5.8 0-1.9-.2-3.9-.6-5.8zM9.6 15.5V8.5L16 12l-6.4 3.5z"/></svg>
        </a>
      </div>
      <div class="footer-right">
        <a href="./privacy.html">Privacy Policy</a>
        <a href="./terms.html">Terms &amp; Conditions</a>
        <a href="./legal.html">Legal Information</a>
      </div>
    </div>
  </footer>

  <!-- Page script -->
  <script>
    // Panel expand buttons (matches C.html behavior)
    function toggleExpand(which, btn){
      const app = document.getElementById('appRoot');
      if (which === 'left'){
        const on = !app.classList.contains('collapsed-left');
        app.classList.toggle('collapsed-left', on);
        btn?.setAttribute('aria-pressed', String(on));
      } else {
        const on = !app.classList.contains('collapsed-right');
        app.classList.toggle('collapsed-right', on);
        btn?.setAttribute('aria-pressed', String(on));
      }
    }

    // --- Tool forms (rendered into #formHost) ---
    const forms = {
      tt: () => `
        <h3 class="title">Generate Truth Table</h3>
        <div class="stack">
          <label>Variables (comma separated)</label>
          <input id="vars" type="text" placeholder="A,B,C" />
          <label>Expression</label>
          <input id="expr" type="text" placeholder="A + B'C" />
          <button class="btn primary" id="doRun">Run</button>
        </div>
      `,
      min: () => `
        <h3 class="title">Minimize Expression</h3>
        <div class="stack">
          <label>Expression</label>
          <input id="expr" type="text" placeholder="A + AB + ABC" />
          <button class="btn primary" id="doRun">Run</button>
        </div>
      `,
      min_tt: () => `
        <h3 class="title">Minimize with Truth Table</h3>
        <div class="stack">
          <label>Variables (comma separated)</label>
          <input id="vars" type="text" placeholder="A,B,C,D" />
          <label>On-set minterms (Σm)</label>
          <input id="mins" type="text" placeholder="0,1,2,5,7" />
          <label>Don't cares (optional)</label>
          <input id="dcs" type="text" placeholder="-" />
          <button class="btn primary" id="doRun">Run</button>
        </div>
      `,
      logic_generic: () => `
        <h3 class="title">Create Logic Diagram — Generic</h3>
        <div class="stack">
          <label>Expression</label>
          <input id="expr" type="text" placeholder="(A + B') · C" />
          <button class="btn primary" id="doRun">Draw</button>
        </div>
      `,
      logic_nand: () => `
        <h3 class="title">Create Logic Diagram — NAND</h3>
        <div class="stack">
          <label>Expression</label>
          <input id="expr" type="text" placeholder="A + B'C" />
          <button class="btn primary" id="doRun">Draw</button>
        </div>
      `,
      logic_nor: () => `
        <h3 class="title">Create Logic Diagram — NOR</h3>
        <div class="stack">
          <label>Expression</label>
          <input id="expr" type="text" placeholder="A + B'C" />
          <button class="btn primary" id="doRun">Draw</button>
        </div>
      `,
      sop_pos: () => `
        <h3 class="title">Find SOP &amp; POS</h3>
        <div class="stack">
          <label>Expression</label>
          <input id="expr" type="text" placeholder="A + B'C" />
          <button class="btn primary" id="doRun">Compute</button>
        </div>
      `,
      kmap: () => `
        <h3 class="title">Generate KMap</h3>
        <div class="stack">
          <label>Command</label>
          <input id="cmd" type="text" placeholder="kmap A,B,C : Σm(1,3,5) d(0,7)" />
          <button class="btn primary" id="doRun">Plot</button>
        </div>
      `
    };

    const formHost = document.getElementById('formHost');
    const toolSelect = document.getElementById('toolSelect');
    const logicMount = document.getElementById('logicMount');
    const tableMount = document.getElementById('tableMount');
    const textMount  = document.getElementById('textMount');
    const leftFoot   = document.getElementById('leftFoot');
    const centerFoot = document.getElementById('centerFoot');
    const rightFoot  = document.getElementById('rightFoot');

    function setStatus(where, txt, cls){
      const el = where === 'left' ? leftFoot : where === 'center' ? centerFoot : rightFoot;
      if (!el) return;
      el.textContent = txt || '';
      if (cls) el.className = 'msg ' + cls;
    }

    function renderForm(kind){
      formHost.innerHTML = forms[kind]();
      // wire the "Run/Draw" button per tool
      const doRun = document.getElementById('doRun');
      if (!doRun) return;

      doRun.onclick = () => {
        const v = id => document.getElementById(id)?.value?.trim() || '';
        // clear outputs every run
        logicMount.innerHTML = '';
        tableMount.innerHTML = '';
        textMount.textContent = '';

        try {
          switch(kind){
            case 'logic_generic': {
              const expr = v('expr');
              if (!expr) { setStatus('center','Enter an expression','error'); return; }
              // uses your existing boolean-nobend.js (generic gates)
              window.renderNoBend(expr, '#logicMount');
              setStatus('center','Diagram OK','success');
              break;
            }
            case 'logic_nand': {
              const expr = v('expr');
              // TODO: call your NAND-only renderer here
              textMount.textContent = 'NAND diagram (todo) for: ' + expr;
              setStatus('center','NAND mode (stub)','ready');
              break;
            }
            case 'logic_nor': {
              const expr = v('expr');
              // TODO: call your NOR-only renderer here
              textMount.textContent = 'NOR diagram (todo) for: ' + expr;
              setStatus('center','NOR mode (stub)','ready');
              break;
            }
            case 'tt': {
              const vars = v('vars');
              const expr = v('expr');
              // TODO: call your truth-table generator; render table into tableMount
              textMount.textContent = `Truth table (todo)\nVars: ${vars}\nExpr: ${expr}`;
              setStatus('center','Truth table (stub)','ready');
              break;
            }
            case 'min': {
              const expr = v('expr');
              // TODO: call your minimizer
              textMount.textContent = 'Minimized (todo) for: ' + expr;
              setStatus('center','Minimize (stub)','ready');
              break;
            }
            case 'min_tt': {
              const vars = v('vars'), mins = v('mins'), dcs = v('dcs');
              // TODO: run with on-set + dont cares
              textMount.textContent = `Minimize with TT (todo)\nVars: ${vars}\nΣm: ${mins}\nd( ): ${dcs}`;
              setStatus('center','Minimize w/ TT (stub)','ready');
              break;
            }
            case 'sop_pos': {
              const expr = v('expr');
              // TODO: compute SOP/POS forms
              textMount.textContent = 'SOP & POS (todo) for: ' + expr;
              setStatus('center','SOP/POS (stub)','ready');
              break;
            }
            case 'kmap': {
              const cmd = v('cmd');
              // TODO: parse and draw KMap (you already have parsing patterns in your existing page)
              textMount.textContent = 'KMap (todo): ' + cmd;
              setStatus('center','KMap (stub)','ready');
              break;
            }
          }
        } catch (e){
          console.error(e);
          setStatus('center','Error: ' + (e?.message || e), 'error');
        }
      };
    }

    // Initialize
    toolSelect.addEventListener('change', () => renderForm(toolSelect.value));
    renderForm(toolSelect.value);

    // Optional: theme toggle hook (if you have it elsewhere)
    document.getElementById('themeToggle')?.addEventListener('click', () => {
      document.body.classList.toggle('light');
    });

    // Reset clears outputs
    document.getElementById('btnReset')?.addEventListener('click', () => {
      document.getElementById('logicMount').innerHTML = '';
      document.getElementById('tableMount').innerHTML = '';
      document.getElementById('textMount').textContent = '';
      setStatus('center','Cleared','ready');
    });
  </script>
</body>
</html>
